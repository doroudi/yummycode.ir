---
title: ุณุงุฎุช ุฎุฒูุฏู ูุจ ุจุง Scrapy
date: 2020-08-22
published: true
tags: ['ูพุงุชูู','scrapy','crawler', 'python', 'datamining', 'tutorial']
canonical_url: false
description: "ุฏุฑ ุงู ุงุฏุฏุงุดุช ุจุง Scrapy ฺฉ ุฎุฒูุฏู ูุจ ุจุฑุง ุฏุฑุงูุช ูุณุช ููู ูุง ุณุงุช Imdb ุฎูุงูู ฺฉุฑุฏ ู ุจุง ููุงูู ูพุงู ุฎุฒูุฏู ูุจ ุฏุฑ ฺฉ ูุซุงู ุนูู ุขุดูุง ู ุดูู."
cover_image: ./images/2/scrapy.jpg
---

> ูฺฉุชู:
> ุงู ุงุฏุฏุงุดุช ุฑุง ูพุดุชุฑ ุฏุฑ ูุฑฺฏูู [ููุชุดุฑ ฺฉุฑุฏู ุจูุฏู](https://virgool.io/@doroudi/%D8%B3%D8%A7%D8%AE%D8%AA-%D8%AE%D8%B2%D9%86%D8%AF%D9%87-%D9%88%D8%A8-%D8%A8%D8%A7-scrapy-q3i67sbemtm5) ู ุจุง ฺฉู ุงุตูุงุญ ุงูุฌุง ููุชุดุฑ ู ุดูุฏ

ุงุฎุฑุง ุจุฑุง ูพุฑูฺู ุง ูุงุฒ ุจู ุงุณุชุฎุฑุงุฌ ุฏุงุฏู ุงุฒ ุณุงุช IMDB ุฏุงุดุชู ุ ุงูุจุชู ุฎูุฏ ุณุงุช IMDB ุจุฎุด ุงุฒ ุงุทูุงุนุงุช ููู ูุง ุฑู ุจุตูุฑุช ูุงู CSV ุฏุฑ ุงุฎุชุงุฑุชูู ูุฑุงุฑ ูุฏู ูู ุงู ุงุทูุงุนุงุช ฺูุฏุงู ฺฉุงูู ูุจูุฏ ู ูุฌุจูุฑ ุดุฏู ุจุฑุง ุงู ฺฉุงุฑ ฺฉ ุฎุฒูุฏู ูุจ ุจุง Scrapy ุงุฌุงุฏ ฺฉูู ุฏุฑ ุงู ุงุฏุฏุงุดุช ุณุน ูฺฉูู ูุฑุงูุฏ ุชูุณุนู ุงู ุฎุฒูุฏู ู ุงูุจุชู ูุญูู ุงุณุชูุงุฏู ุงุฒ scrapy ุจุฑุง ุงู ููุธูุฑ ุฑุง ุชูุถุญ ุจุฏูู.

## ุฎุฒูุฏู ูุจ ฺุณุชุ 

ุฎุฒูุฏู ูุจ ุง Web Crawler ุงุจุฒุงุฑ ุงุณุช ฺฉู ูุฑุงูุฏ ุฏุฑุงูุช ุฏุงุฏู ูุง ููุฌูุฏ ุฏุฑ ุตูุญุงุช ูุจ ุฑุง ุฎูุฏฺฉุงุฑ ู ฺฉูุฏุ ุจุฑุง ูุซุงู ุฏูุณุช ุฏุงุฑุฏ ูุณุช ููุช ูุญุตููุงุช ุฏุฌฺฉุงูุง ุฑุง ุจุตูุฑุช ุฑูุฒุงูู ุฏุฑุงูุช ฺฉูุฏ ู ุชุบุฑุงุช ุฑุง ููุงุณู ฺฉูุฏ ุ ุฏุฌฺฉุงูุง ูฺ API ุง ุจุฑุง ุฏุณุชุฑุณ ุจู ุงุทูุงุนุงุช ูุญุตููุงุชุด ุฏุฑุงุฎุชุงุฑ ุนููู ูุฑุงุฑ ููุฏู ุ ูพุณ ุง ุจุงุฏ ุจู ุตูุฑุช ุฏุณุช ููุช ูุง ุฑู ฺฉูพ ฺฉูู ๐ ุง ุงุจุฒุงุฑ ุฏุงุดุชู ุจุงุดู ฺฉู ุงู ฺฉุงุฑ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุงูุฌุงู ุจุฏู ุ ุฎุฒูุฏู ูุง ูุจ ุฏููุง ุจุฑุง ุงู ููุธูุฑ ุณุงุฎุชู ุดุฏู ุงูุฏ. ุฎุฒูุฏู ูุจ ูุญุชูุง ูุจุณุงุช ุฑุง ุฏุงูููุฏ ู ฺฉูุฏ ู ุจุฎุด ูุง ุงุฒ ุณุงุช ฺฉู ูุญุชูุง ููุฑุฏ ูุธุฑ ูุง ุงููุฌุง ูุฑุงุฑ ุฏุงุฑุฏ ุฑู ุงุณุชุฎุฑุงุฌ ูฺฉูุฏ.

![ุฎุฒูุฏู ูุจ ฺุณุช](./images/2/1.jpeg)

## ุงุณฺฉุฑูพ ฺุณุชุ

![scrapy](./images/2/2.png)
ุงุจุฒุงุฑูุง ูุฎุชูู ุจุฑุง ุฏุงุฏู ฺฉุงู ุฏุฑ ูุจ ูุฌูุฏ ุฏุงุฑู ุ ฺฉ ุงุฒ ุฑุงุญุช ุชุฑู ุงูู ูุง ูพูุงฺฏู Data Scraper ุจุฑุง ูุฑูุฑฺฏุฑ ฺฉุฑูู ูุณุช (ุงูุจุชู ูพูู ูพูู ุฏุงุฑู) ุ ูู ุงฺฏุฑ ฺฉู ุจุฑูุงูู ููุณ ุจูุฏ ุจุงุดุฏ ุณุงุฎุช ฺฉ ุฎุฒูุฏู ูุจ ุจุง Scrapy ุงุตูุง ฺฉุงุฑ ุณุฎุช ูุณุช ุ ุฏุฑ ูุงูุน Scrapy ฺฉ ูุฑู ูุฑฺฉ ูุจุชู ุจุฑ ูพุงุชูู ุจุฑุง ุณุงุฎุช ุฎุฒูุฏู ูุง ูุจ ุงุณุช. Scrapy ูุฑุงูุฏ ุณุงุฎุช ุ ุงุฌุฑุง ู ุฐุฎุฑู ุฎุฑูุฌ ุฎุฑูุฏู ูุจ ุฑู ูพูุดุด ูุฏู.

### ฺฏุงู ุงูู: ูุตุจ Scrapy

ุงฺฏุฑ ูุจูุง ุฑู ุณุณุชู ุชุงู ูพุงุชูู ูุตุจ ฺฉุฑุฏู ุงุฏ ู ุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ pip ุงูุฏุงู ุจู ูุตุจ Scrapy ฺฉูุฏ

```bash
pip install Scrapy
```

ุจุฑ ุฎูุงู ุงูู ฺุฒ ฺฉู ุงูุชุธุงุฑ ุฏุงุดุชู ูุตุจ Scrapy ุญุฏุงูู ุฏุฑ ููุฏูุฒ ู ุจุง ูุณุฎู 3.6 ูพุงุชูู ฺฉู ุจู ูุดฺฉู ุจุฑ ูุฎูุฑู ูู ุจุง ูุณุฎู 2.7 ูพุงุชูู ููู ฺุฒ ุฎูุจ ูพุด ุฑูุช ุ ูู ูุชุฌู ุชุฌุฑุจู ุง ฺฉู ุฏุฑ ูุตุจ scrapy ุฏุฑ ููุฏูุฒ ุฏุงุดุชู ุงูู ฺฉู ุจูุชุฑู ุฑุงู ุจุฑุง ูุตุจ Scrapy ุญุฏุงูู ุฏุฑ ููุฏูุฒ  ุงุณุชูุงุฏู ุงุฒ Anaconda ู ุงูุจุชู ูุณุฎู ฺฉู ุญุฌู ุงูู ุนู MiniConda ุงุณุช ุ ูุงุฒ ุจู ูุตุจ ููุณุฑ Python ูุณุช ู ููู ฺุฒ ููุฑุงู ุขูุงฺฉููุฏุง ูุตุจ ูุดู.
ุจุนุฏ ุงุฒ ุฏุงูููุฏ ู ูุตุจ Miniconda ููุจุช ุจู ูุตุจ Scrapy ูุฑุณู ุ ฺฉุงูู ุฏุฑ ุฎุท ูุฑูุงู ุฏุณุชูุฑ ุฒุฑ ุฑู ุจุฑุง ูุตุจ Scrapy ุงุฌุฑุง ฺฉูุฏ

```bash
conda install -c conda-forge scrapy
```

ูพุณ ุงุฒ ูพุงุงู ูุตุจ ูโุชูุงูุฏ ุงุฒ ุทุฑู ุฏุณุชูุฑ scrapy ุงุฒ ูููู ุจูุฏู ูุตุจ ุงูู ุงุทููุงู ุญุงุตู ฺฉูุฏ

![scrapy](./images/2/2.jpeg)

### ุชุณุช Scrapy

ูพุด ุงุฒ ุงูฺฉู ุฏุฑฺฏุฑ ฺฉุฏููุณ ุจุดูุฏุ ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุดู scrapy ุงุฒ ุงูฺฉุงูุงุช ุงูู ุจุตูุฑุช ุชุนุงูู ุงุณุชูุงุฏู ฺฉูุฏ ุ ฺฉุงุฑ ุจุณุงุฑ ุณุงุฏู ุงุณุช ู ฺฉุงูู ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ูุงุฑุฏ shell ุจุดูุฏ:

```bash
scrapy shell <website_url>
```

ุจุนุฏ ุงุฒ ุงุฌุฑุง ุงู ุฏุณุชูุฑ ุตูุญู ูุจ ุฏุงูููุฏ ูุดู ู ูุงุฑุฏ ูุญุท shell ู ุดูุฏ ู ู ุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุงูุชุฎุงุจฺฏุฑ ูุง ููุฌูุฏ ุจู ุงููุงู ูุง ููุฌูุฏ ุฏุฑ ุตูุญู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ:
ุจุฑุง ูุซุงู ุงูุชุฎุงุจ ุนูุงูู 250 ููู ุจุฑุชุฑ ุฏุฑ imdb:

```bash
scrapy shell https://www.imdb.com/chart/top
```

ุจุง ุงุณุชูุงุฏู ุงุฒ ุขุจุฌฺฉุช response ู ุชูุงู ุจู ูุญุชูุง ุตูุญู ุฏุงูููุฏ ุดุฏู ุฏุณุชุฑุณ ุฏุงุดุช ุ ุจุฑุง ูุซุงู ุจุฑุง ูุดุงูุฏู ฺฉุฏ html ุตูุญู ุฏุงูููุฏ ุดุฏู ูโุชูุงู ุงุฒ response.body ุงุณุชูุงุฏู ฺฉุฑุฏ.
ุจุฑุง ุงูุชุฎุงุจ ุงููุงู ูุง ูุดุฎุต scrapy ุฏู ุฑุงู ุญู ูุฏุฑุชููุฏ ุฏุฑ ุงุฎุชุงุฑุชุงู ูุฑุงุฑ ูุฏูุฏ :

* ุงูุชุฎุงุจฺฏุฑ CSS
* ุงูุชุฎุงุจฺฏุฑ xpath

ุงฺฏุฑ ุจุง html ู css ุขุดูุง ุฏุงุดุชู ุจุงุดุฏ ุงุณุชูุงุฏู ุงุฒ ุงูุชุฎุงุจฺฏุฑ css ุจุฑุงุชุงู ุจุณุงุฑ ุณุงุฏู ุฎูุงูุฏ ุจูุฏ ุ ุจุฑุง ูุซุงู ุงูุชุฎุงุจ ุนูุงูู ููู ูุง ููุฌูุฏ ุฏุฑ IMDB ู ุชูุงูุฏ ุจุง ุงูุชุฎุงุจฺฏุฑ ุฒุฑ ุงูุฌุงู ุดูุฏ:

```css
.lister-list .titleColumn a
```

![scrapy selector](./images/2/3.jpeg)

```python
response.css(".lister-list .titleColumn a::text").extract()
```

![top movies of imdb scrapy](./images/2/4.jpeg)

ุชุจุฑฺฉ ูฺฏู ุ ุจู ููู ุณุงุฏฺฏ ูุณุช ููู ูุง ุจุฑุชุฑ ููุฌูุฏ ุฏุฑ ูุจ ุณุงุช imdb ุฑู ุงุณุชุฎุฑุงุฌ ฺฉุฑุฏู.
ููุงูุทูุฑ ฺฉู ูุดุฎุต ุงุณุช ุ ุจุฑุง ุฏุฑุงูุช ูุชู ุงููุงู ูุชูุงู ุงุฒ text:: ุงุณุชูุงุฏู ฺฉุฑุฏ ู ุจุฑุง ุงุณุชุฎุฑุงุฌ ุจุงุฏ ูุชุฏ extract ุฑุง ุจุนุฏ ุงุฒ ุงูุชุฎุงุจฺฏุฑ css ุชุงู ุจููุณุฏ. ุจุฑุง ุงูุชุฎุงุจ ุงููุงู ูุฎุณุช ูโุชูุงูุฏ ุงุฒ extract_first ุงุณุชูุงุฏู ฺฉูุฏ.
ุงูุชุฎุงุจฺฏุฑ xpath ุฑูุด ุฏฺฏุฑ ุจุฑุง ุงูุชุฎุงุจ ุนูุงุตุฑ ููุฌูุฏ ุฏุฑ ุตูุญู ูุจ ูุจุชู ุจุฑ xml ุงุณุช ู ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุงุจุฒุงุฑ Developer Tool ููุฌูุฏ ุฏุฑ ูุฑูุฑฺฏุฑุชุงู ุขุฏุฑุณ xpath ูุฑุจูุท ุจู ุงููุงู ุงูุชุฎุงุจ ุชุงู ุฑุง ุฏุฑุงูุช ฺฉูุฏ

![xpath selector chrome devtools for scrapy](./images/2/5.jpeg)

ุจุฑุง ูุซุงู ุงูุชุฎุงุจฺฏุฑ ุนููุงู ููู ูุง ุจุง xpath ุจู ุดฺฉู ุฒุฑ ุงุณุช:

```python
response.xpath("/html/body/div[1]/div/div[2]/div[3]/div/div[1]/div/span/div/div/div[3]/table/tbody/tr[1]/td[2]/a/text()").extract()
```

[ุงุทูุงุนุงุช ุจุดุชุฑ ุฏุฑุจุงุฑู xpath](https://docs.scrapy.org/en/xpath-tutorial/topics/xpath-tutorial.html)

### ุงุฌุงุฏ ูพุฑูฺู

ูฺฉุฑ ูฺฉูู ุชุง ุงูุฌุง ุชูุถุญ ฺฉุงูู ุ ุจุงุฏ ุงููู ูพุฑูฺู ูุงู ุฑุง ุงุฌุงุฏ ฺฉูู ุ ูุฑฺูุฏ ฺฉู ู ุชูุงูุฏ ฺฉ ูพุฑูฺู ุณุงุฏู ุจุง ูพุงุชูู ุงุฌุงุฏ ฺฉูุฏ ู ุจุง import ฺฉุฑุฏู scrapy ุงุฒ ุงูฺฉุงูุงุช scrapy ุฏุฑ ุขู ุงุณุชูุงุฏู ฺฉูุฏ ูู ูพุดููุงุฏ ูฺฉูู ุงุฒ ุฏุณุชูุฑ startproject ุจุฑุง ุงุฌุงุฏ ูพุฑูฺู ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
scrapy startproject <project_name>
```

ุงููู ูพุฑูฺู ูุงู ุฑุง ุจุง ูุงู imdb ุงุฌุงุฏ ฺฉุฑุฏู ุ ฺฉ ูพูุดู ุจุง ูุงู ูพุฑูฺู ุชุงู ุจู ููุฑุงู ฺูุฏู ูุงู ุจุฑุงุชุงู ุงุฌุงุฏ ุดุฏ ุ ฺฏุงู ุจุนุฏ ุงุฌุงุฏ ุงููู spider ูุงู ุงุณุช ุ ูุฑ ูพุฑูฺู scrapy ู ุชูุงูุฏ ุดุงูู ฺูุฏู ุงุณูพุงุฏุฑ ุจุงุดุฏ ฺฉู ูุฑ ฺฉุฏุงู ู ุชูุงูุฏ ูุณุฆูู ุฏุฑุงูุช ุฏุงุฏู ูุง ุจุฎุด ูุง ูุชูุงูุช ุงุฒ ฺฉ ูุจุณุงุช ุจุงุดูุฏ.
ุจุฑุง ุงุฌุงุฏ ุงููู spider ฺฉุงูุณุช ุจุนุฏ ุงุฒ ูุฑูุฏ ุจู ูพูุดู ูพุฑูฺู ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ:

```bash
cd imdb
scrapy genspider topMovies https://www.imdb.com/chart/top
```

ุฏุงุฎู ูพูุดู spiders ฺฉ ูุงู ูพุงุชูู ุฌุฏุฏ ุจุง ูุงู topMovies ุงุถุงูู ุดุฏู ุงุณุช ุ ูุนูุง ููุท ุจุง ุงู ูุงู ฺฉุงุฑ ุฎูุงูู ฺฉุฑุฏ ุ ูพุดููุงุฏ ูู ุจุฑ ูุฑุงุด ุงู ูุงู ุงุณุชูุงุฏู ุงุฒ [Visual Studio Code](https://code.visualstudio.com/) ู ุง ูุฑุงุดฺฏุฑ ูุฎุตูุต ูพุงุชูู [PyCharms](https://www.jetbrains.com/pycharm/) ูุณุช (ฺฏุฒูู ุฏูู ุบุฑ ุฑุงฺฏุงู ูุณุช).

![Visual Studio Code](./images/2/6.jpeg)

ููุงูุทูุฑ ฺฉู ูุดุงูุฏู ู ฺฉูุฏ ุ ูุฑ ุงุณูพุงุฏุฑ ุฏุฑ ูุงูุน ฺฉ ฺฉูุงุณ ูพุงุชูู ุงุณุช ฺฉู ุงุฒ scrapy.Spider ุงุฑุซ ุจุฑ ุฏุงุฑุฏ.
ููุฏุงุฑ allowed_domains ู start_urls ุจู ุชุฑุชุจ ุฏุงููู ูุง ฺฉู ุฎุฒูุฏู ูุฌุงุฒ ุจู ูพูุงุด ูุณุช ู ุขุฏุฑุณ ูุง ุขุบุงุฒู ูุณุช ฺฉู ูุฑ ฺฉุฏุงู ูุชูุงูุฏ ฺูุฏู ููุฏุงุฑ ุฏุงุดุชู ุจุงุดูุฏ ู ุจู ุตูุฑุช ูพุด ูุฑุถ ุขุฏุฑุณ ุงุณุช ฺฉู ููฺฏุงู ุงุฌุงุฏ ุงุณูพุงุฏุฑ ูุงุฑุฏ ฺฉุฑุฏู ุจูุฏู.
ูุชุฏ ุงุตู parse ูุณุช ู ุจุนุฏ ุงุฒ ุฏุงูููุฏ ูุฑ ฺฉ ุงุฒ url ูุง ููุฌูุฏ ุฏุฑ start_urls ุงุฌุฑุง ุฎูุงูุฏ ุดุฏุ ููุงูุทูุฑ ฺฉู ูุดุฎุต ูุณุช ฺฉ ุงุฒ ูพุงุฑุงูุชุฑ ูุง ุงู ูุชุฏ response ูุณุช ู ููุงู response ุง ุงุณุช ฺฉู ุฏุฑ shell ุจู ุขู ุฏุณุชุฑุณ ุฏุงุดุชู ู ูุชูุงูู ุงุฒ ุทุฑู ุขู ู ุงุณุชูุงุฏู ุงุฒ ุงูุชุฎุงุจฺฏุฑ ูุง ุจู ูุญุชูุง ููุฑุฏ ูุธุฑูุงู ุฏุณุช ุงุจู.

### ุฏุฑุงูุช ูุณุช ููู ูุง

ูุชูุงูู ุงุฒ ููุงู ุงูุชุฎุงุจฺฏุฑ ฺฉู ุฏุฑ ูุญุท ุดู ุจุฑุง ุฏุฑุงูุช ูุณุช ููู ูุง ุงุณุชูุงุฏู ฺฉุฑุฏู ุจูุฏู ุฏุฑ ุฏุฑูู ฺฉุฏูุงู ุงุณุชูุงุฏู ฺฉูู (ูุนูุง ุงุฒ ุฏุณุชูุฑ print ุจุฑุง ููุงุด ุฎุฑูุฌ ุงุณุชูุงุฏู ฺฉุฑุฏู)

```python

import scrapy
import json
from ..items import MovieItem

class TopmoviesSpider(scrapy.Spider):
    name = 'topMovies'
    allowed_domains = ['imdb.com']
    start_urls = ['https://www.imdb.com/chart/top/']

    def parse(self, response):
        links = response.css(".lister-list tr a::attr(href)").extract()
        for link in links:
            link = response.urljoin(link)
            print(link)
            yield scrapy.Request(url=link, callback=self.parse_details)

    def parse_details(self, response):
        json_res = json.loads(response.xpath(
            "//script[@type='application/ld+json']/text()").extract_first())
        film = MovieItem()
        if 'name' in json_res:
            film['name'] = json_res['name']
        if 'image' in json_res:
            film['image'] = json_res['image']
        if 'genre' in json_res:
            film['genre'] = json_res['genre']
        if 'contentRating' in json_res:
            film['contentRating'] = json_res['contentRating']
        if 'actor' in json_res:
            film['actor'] = json_res['actor']
        if 'creator' in json_res:
            film['creator'] = json_res['creator']
        if 'description' in json_res:
            film['description'] = json_res['description']
        if 'keywords' in json_res:
            film['keywords'] = json_res['keywords']
        if 'aggregateRating' in json_res:
            film['aggregateRating'] = json_res['aggregateRating']
        if 'review' in json_res:
            film['review'] = json_res['review']
        if 'trailer' in json_res:
            film['trailer'] = json_res['trailer']
        if 'duration' in json_res:
            film['duration'] = json_res['duration']

        yield film
```

ูุชูุงูุฏ ุฎุฒูุฏู ุงุฌุงุฏ ุดุฏู ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ ุฒุฑ ุงุฌุฑุง ฺฉูุฏ:

```bash
scrapy crawl topMovies
```

ุฎุฑูุฌ

![alt](./images/2/7.jpeg)

ุจูุชุฑ ุงุณุช ุจู ุฌุง ุงุณุชูุงุฏู ุงุฒ print ุจุฑุง ููุงุด ุฎุฑูุฌ ูุชุฌู ุฏูุฎูุงู ุฑุง ุจู ุนููุงู ููุฏุงุฑ ุจุฑฺฏุดุช ูุชุฏ parse ุจุฑฺฏุฑุฏุงูู ุ ุจุฑุง ูุซุงู ุฏุฑ ฺฉุฏ ุฒุฑ ุจู ุฌุฒ ุนููุงู ุ ุชุตูุฑ ุ ููฺฉ ู ุงูุชุงุฒ ููู ูุง ุฑู ูู ุฏุฑุงูุช ฺฉุฑุฏู ุ ูฺฉุชู ุฌุฏุฏ ุงุณุชูุงุฏู ุงุฒ

```css
::attr(src)
```

ุจุฑุง ุฏุฑุงูุช ูุดุฎุตู src ุชฺฏ img ุงุณุช.

```python

import scrapy
class TopmoviesSpider(scrapy.Spider):
    name = 'topMovies'
    allowed_domains = ['imdb.com']
    start_urls = ['https://www.imdb.com/chart/top/']

    def parse(self, response):
        movies = response.css(".lister-list tr")
        for movie in movies:
            yield {
                'image': movie.css('.posterColumn img::attr(src)').extract_first(),
                'title': movie.css('.titleColumn a::text').extract_first(),
                'link': movie.css('.titleColumn a::text').extract_first(),
                'rate': movie.css('.ratingColumn strong::text').extract_first()
            }
            pass
```

ุจุฑุง ุฐุฎุฑู ุฎุฑูุฌ ุชููุฏ ุดุฏู ุชูุณุท ุฎุฒูุฏู ุชุงู ูุชูุงูุฏ ุงุฒ ูุงู ูุงู ุจู ููุฑุงู ูพุงุฑุงูุชุฑ o ุฏุฑ ุฏุณุชูุฑ ุงุฌุฑุง ุฎุฒูุฏู ุงุณุชูุงุฏู ฺฉูุฏ:

```bash
scrapy crawl topMovies -o movies.json
```

ุฎุฑูุฌ

![scrapy output of top movies from IMDB.com](./images/2/8.jpeg)

ูพุณููุฏ ูุงู ูุง ฺฉู ุชูุณุท scrapy ูพุดุชุจุงู ู ุดููุฏ ุนุจุงุฑุชูุฏ ุงุฒ :

* JSON
* JSON lines
* CSV
* XML

### ุฏุฑุงูุช ุฌุฒุฆุงุช ููู

ุจุฑุง ุฏุฑุงูุช ุฌุฒุฆุงุช ููู ูุง ูุงุฒ ูุณุช ฺฉู ุฎุฒูุฏู ูุงุฑุฏ ููฺฉ ูุฑ ููู ุจุดู ู ุงุทูุงุนุงุช ฺฉุงูู ูุฑ ููู ุฑู ุงุฒ ุตูุญู ุฌุฒุฆุงุช ุจุฎููู ุ ฺฉุฏูุงู ุฑู ุจู ฺฏููู ุง ุชุบุฑ ูุฏู ฺฉู ุจู ููุท ูุณุช ููฺฉ ูุง ุฑู ุงุฒ ุตูุญู ุงุตู ุจุฎููู ู ุณุงุฑ ููุฏ ูุง ุฑู ุงุฒ ุตูุญู ุฌุฒุฆุงุช.
ุจุฑุง ุฏุฑุงูุช ุตูุญู ุฌุฏุฏ ู ุงุฌุฑุง ูุชุฏ parse ุฑู ุงูู ูุงุฒ ุฏุงุฑู ฺฉู ุงุฒ scrapy.Request ุงุณุชูุงุฏู ฺฉูู ุ ฺฉู ูพุงุฑุงูุชุฑ ุฏูู ุงูู ูุชุฏ ุงุณุช ฺฉู ุจุนุฏ ุงุฒ ุฏุฑุงูุช ุจุงุฏ ุนููุงุช parse ุฑู ุงูุฌุงู ุจุฏู
ฺูู url ูุง ุจุตูุฑุช relative ุซุจุช ุดุฏู ุงูุฏ ุงุฒ response.urljoin ุจุฑุง ุชุตุญุญ ููฺฉ ุงุณุชูุงุฏู ฺฉุฑุฏู:

```python
def parse(self, response):
    links = response.css(".lister-list tr a::attr(href)").extract()
    for link in links:
         link = response.urljoin(link)
         yield scrapy.Request(url=link, callback=self.parse_details)
def parse_details(self, response):
    #parse details
```

ุจุฑุง ุงูฺฉู ุณุงุฎุชุงุฑ ููุณุฌู ุชุฑ ุฏุงุดุชู ุจุงุดู ูุชูุงูู ฺฉูุงุณ ูุฏู ุจุฑุง ุฏุงุฏู ูุง ุจุฑฺฏุดุช ุฏุงุดุชู ุจุงุดู ุ ูุงู items ุฏุฑ ูพุฑูฺู Scrapy ุจุฑุง ุงู ููุธูุฑ ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏู ู ูุชููุฏ ูุฏู ุฑู ุชู ุงู ูุงู ุชุนุฑู ฺฉูุฏ:

```python
class MovieItem(scrapy.Item):
    url = scrapy.Field()
    name = scrapy.Field()
    image = scrapy.Field()
    genre = scrapy.Field()
    contentRating = scrapy.Field()
    actor = scrapy.Field()
    creator = scrapy.Field()
    description = scrapy.Field()
    datePublished = scrapy.Field()
    keywords = scrapy.Field()
    aggregateRating = scrapy.Field()
    review = scrapy.Field()
    trailer = scrapy.Field()
    duration = scrapy.Field()
    pass
```

ุจุฑุง ุฏุฑุงูุช ููุฏ ูุง ูุชูุงูุฏ ุงุฒ ุฑูุด ูุจู (ุงุณุชูุงุฏู ุงุฒ ุงูุชุฎุงุจฺฏุฑ css) ุงุณุชูุงุฏู ฺฉูุฏ ูู ุงฺฏุฑ ฺฉู ุฏุฑ ฺฉุฏ ุตูุญู ุฌุฒุฆุงุช ููู ุฏุฑ imdb ุฏูุช ฺฉูุฏ ูุชูุฌู ุฎูุงูุฏ ุดุฏ ฺฉู ุงู ุชู ุงู ุตูุญู ุฌุฒุฆุงุช ฺฉุงูู ููู ุชู ฺฉ ุชฺฏ ุงุณฺฉุฑูพุช ุจุตูุฑุช json ุฏุงุฑู ู ุจุง ฺฉูุชุฑ ุฒุญูุช ูุชููุฏ ุงุทูุงุนุงุช ุฑู ุงุฒ ุงููุฌุง ุฏุฑุงูุช ฺฉูุฏ:

![source](./images/2/9.jpeg)

ุจุฑุง ุฏุฑุงูุช ูุญุชูุง ุงุณฺฉุฑูพุช ูุชููุฏ ุจู ุฌุง ุงูุชุฎุงุจฺฏุฑ css ุงุฒ xpath ุงุณุชูุงุฏู ฺฉูุฏ:

```python
response.xpath("//script[@type='application/ld+json']/text()").extract_first()
```

ููุฏุงุฑ ฺฉู ุจุฑ ูฺฏุฑุฏู ุจุตูุฑุช ุฑุดุชู ุงุณุช ู ุจุงุฏ ุจู json ุชุจุฏู ุจุดู ุ ูุชููุฏ ุงุฒ json.loads ุงุณุชูุงุฏู ฺฉูุฏ:

```python
json.loads(response.xpath("//script[@type='application/ld+json']/text()").extract_first())
```

ฺฉุฏ ููุง

```python
import scrapy
import json
from ..items import MovieItem

class TopmoviesSpider(scrapy.Spider):
    name = 'topMovies'
    allowed_domains = ['imdb.com']
    start_urls = ['https://www.imdb.com/chart/top/']

    def parse(self, response):
        links = response.css(".lister-list tr a::attr(href)").extract()
        for link in links:
            link = response.urljoin(link)
            print(link)
            yield scrapy.Request(url=link, callback=self.parse_details)

    def parse_details(self, response):
        json_res = json.loads(response.xpath(
            "//script[@type='application/ld+json']/text()").extract_first())
        film = MovieItem()
        if 'name' in json_res:
            film['name'] = json_res['name']
        if 'image' in json_res:
            film['image'] = json_res['image']
        if 'genre' in json_res:
            film['genre'] = json_res['genre']
        if 'contentRating' in json_res:
            film['contentRating'] = json_res['contentRating']
        if 'actor' in json_res:
            film['actor'] = json_res['actor']
        if 'creator' in json_res:
            film['creator'] = json_res['creator']
        if 'description' in json_res:
            film['description'] = json_res['description']
        if 'keywords' in json_res:
            film['keywords'] = json_res['keywords']
        if 'aggregateRating' in json_res:
            film['aggregateRating'] = json_res['aggregateRating']
        if 'review' in json_res:
            film['review'] = json_res['review']
        if 'trailer' in json_res:
            film['trailer'] = json_res['trailer']
        if 'duration' in json_res:
            film['duration'] = json_res['duration']

        yield film
```

ุงูุฏูุงุฑู ูุทุงูุจ ฺฉู ูุทุฑุญ ุดุฏ ุจู ุฏุฑุฏุชูู ุจุฎูุฑู ุ ุงูุจุชู ููุงุฑุฏ ูุณุช ฺฉู ูุฑุตุช ูพุฑุฏุงุฎุชู ุจูุดูู ุฏุฑ ุงู ููุงูู ูพุด ูููุฏ ุ ูุซู ุตูุญู ุจูุฏ ุ ุชูุธูุงุช ุ pipeline ูุง ู ... ฺฉู ุณุงุช scrapy ูุฑุฌุน ฺฉุงูู ุจุฑุง ุงุฏฺฏุฑ ุงู ููุงุฑุฏ ูุณุช.
ฺฉุฏ ูพุฑูฺู ุฑู ูุชููุฏ ุงุฒ ฺฏุช ูุงุจ [ฺฏุช ูุงุจ](https://github.com/doroudi/imdb-crawler) ุฏุฑุงูุช ฺฉูุฏ.
